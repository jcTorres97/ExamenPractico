/*! Prototype Map Function| (cag) 2018, Ozelot */
var pagefunction = function () { var e, o = document.querySelector("#Direccion_CP"), l = (document.querySelector("#Direccion_Colonia"), document.querySelector("#Direccion_Ciudad")), t = document.querySelector("#Direccion_Calle"), n = (document.querySelector("#Direccion_Colonia").value, document.querySelector("#Direccion_Latitud")), a = document.querySelector("#Direccion_Longitud"), i = document.querySelector("#Andromeda"); $this = $("#map_canvas3"), $zoom_level = $this.data("gmap-zoom") || 5, $data_lat = $this.data("gmap-lat") || 29.895883, $data_lng = $this.data("gmap-lng") || -80.650635, $xml_src = $this.data("gmap-src") || "/xml/gmap/pins.xml", map = $this; new google.maps.StyledMapType([{ featureType: "landscape", stylers: [{ visibility: "off" }] }, { featureType: "transit", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "labels", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#d3d3d3" }, { visibility: "on" }] }, { featureType: "road", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "landscape", stylers: [{ visibility: "on" }, { hue: "#0008ff" }, { lightness: -75 }, { saturation: 10 }] }, { elementType: "geometry.stroke", stylers: [{ color: "#1f1d45" }] }, { featureType: "landscape.natural", stylers: [{ color: "#1f1d45" }] }, { featureType: "water", elementType: "geometry.fill", stylers: [{ visibility: "on" }, { color: "#01001f" }] }, { elementType: "labels.text.fill", stylers: [{ visibility: "on" }, { color: "#e7e8ec" }] }, { elementType: "labels.text.stroke", stylers: [{ visibility: "on" }, { color: "#151348" }] }, { featureType: "administrative", elementType: "labels.text.fill", stylers: [{ visibility: "on" }, { color: "#f7fdd9" }] }, { featureType: "administrative", elementType: "labels.text.stroke", stylers: [{ visibility: "on" }, { color: "#01001f" }] }, { featureType: "road", elementType: "geometry.fill", stylers: [{ visibility: "on" }, { color: "#316694" }] }, { featureType: "road", elementType: "labels.icon", stylers: [{ visibility: "off" }] }, { featureType: "water", elementType: "labels", stylers: [{ visibility: "off" }] }, { featureType: "poi", elementType: "geometry.fill", stylers: [{ color: "#1a153d" }] }], { name: "Nightvision" }); !function () { console.log("Initizialize.."); var o = { center: new google.maps.LatLng(41.38155, 2.13752), zoom: 12 }; e = new google.maps.Geocoder, map = new google.maps.Map(document.getElementById("map_canvas3"), o); var l = new google.maps.InfoWindow({ map: map }); console.log("Geolocation User"), navigator.geolocation ? navigator.geolocation.getCurrentPosition(function (e) { var o = { lat: e.coords.latitude, lng: e.coords.longitude }; l.setPosition(o), l.setContent("Te encuentras aqui."), map.setCenter(o) }, function () { handleLocationError(!0, l, map.getCenter()) }) : handleLocationError(!1, l, map.getCenter()) }(); var s, r = [], c = {}; function u(o) { e.geocode({ componentRestrictions: { country: "MX", postalCode: o } }, function (e, o) { "OK" == o ? (map.setCenter(e[0].geometry.location), p(e[0].geometry, "postal_code")) : ("ZERO_RESULTS" == o ? console.log("No se encontraron resultados de la busqueda ") : "OVER_QUERY_LIMIT" == o ? console.log("Se excedio la cuota de busqueda ") : "REQUEST_DENIED" == o && console.log("Google Maps Rechazo tu solicitud"), console.log("Geocode was not successful for the following reason: " + o)) }) } function d(n, a) { var i = { lat: parseFloat(n), lng: parseFloat(a) }; e.geocode({ location: i }, function (e, n) { if ("OK" == n) { var a = e[0].address_components; for (index = 0; index < a.length; ++index) { var i = {}, s = e[0].address_components[index].types; for (ind = 0; ind < s.length; ++ind)i[ind] = s[ind]; "route" == i[0] ? t.value = a[index].long_name : "locality" == i[0] ? l.value = a[index].long_name : "postal_code" == i[0] && (o.value = a[index].long_name, o.value.length > 0 && y(o.value)) } } else "ZERO_RESULTS" == n ? console.log("No se encontraron resultados de la busqueda ") : "OVER_QUERY_LIMIT" == n ? console.log("Se excedio la cuota de busqueda ") : "REQUEST_DENIED" == n && console.log("Google Maps Rechazo tu solicitud"), console.log("Geocode was not successful for the following reason: " + n) }) } function p(e, o) { var l = { lat: "", lng: "" }; "postal_code" == o ? (l.lat = e.location.lat(), l.lng = e.location.lng()) : (l.lat = e.latLng.lat(), l.lng = e.latLng.lng()), r.length > 0 ? g() : (g(), c = new google.maps.Marker({ position: l, map: map, title: "Posición", draggable: !0 }), r.push(c)), n.value = l.lat, a.value = l.lng, d(l.lat, l.lng), google.maps.event.addListener(c, "dragend", function (e) { var o; s = e.latLng, o = s, lat = o.lat(), lng = o.lng(), n.value = lat, a.value = lng, d(lat, lng) }) } function g() { !function (e) { console.log("Markers", r.length); for (var o = 1; o <= r.length; o++)r[o].setMap(e); r = [] }(null) } function y(e) { datos = {}, url = "https://api-codigos-postales.herokuapp.com/v2/codigo_postal/" + e, $(document).ready(function () { var e = $("#Direccion_Colonia"); $.getJSON(url, datos, function (o) { e.find("option").remove().end().append('<option value="Selecciona una colonia">Selecciona una colonia</option>').val("Selecciona una colonia"); for (var l = 0; l < o.colonias.length; l++)i ? i.value == o.colonias[l] ? e.append("<option value='" + o.colonias[l] + "' selected>" + o.colonias[l] + "</option>") : (console.log("Add"), e.append("<option value='" + o.colonias[l] + "'>" + o.colonias[l] + "</option>")) : e.append("<option value='" + o.colonias[l] + "'>" + o.colonias[l] + "</option>") }) }) } google.maps.event.addListener(map, "click", function (e) { 0 == r.length && p(e, "drag") }), o.value.length > 0 && (console.log("-----Pre-charge------"), y(o.value), u(o.value)), o.addEventListener("input", function (e) { var n = o.value; console.log("Listen", n), n.length > 4 && (u(n), y(n), t.value = "", l.value = "") }, !1), o.addEventListener("change", function (e) { }, !1) };